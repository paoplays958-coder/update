local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local rootPart = character:WaitForChild("HumanoidRootPart")

local flyEnabled = false
local speedEnabled = false
local jumpEnabled = false
local clickTPEnabled = false  -- Novo: Controla o Click TP
local speedValue = 16
local jumpValue = 50
local flySpeed = 50

local bodyVelocity, bodyGyro, flyConnection

local redzlib = loadstring(game:HttpGet("https://raw.githubusercontent.com/tbao143/Library-ui/refs/heads/main/Redzhubui"))()

local Window = redzlib:MakeWindow({
    Title = "Dragon Hub 0.2",
    SubTitle = "Sistema de Movimento"
})

-- Função para teleportar com clique
local function setupClickTP()
    local mouse = player:GetMouse()

    mouse.Button1Down:Connect(function()
        if not clickTPEnabled or not character or not rootPart then return end

        local targetPosition = mouse.Hit.Position
        if targetPosition and (rootPart.Position - targetPosition).Magnitude <= 1000 then
            rootPart.CFrame = CFrame.new(targetPosition + Vector3.new(0, 3, 0))
        end
    end)
end

local Tab1 = Window:MakeTab({"Movimento", "rbxassetid://7733764088"})

-- ===== Fly System =====
Tab1:AddSection({"Fly System"})

Tab1:AddToggle({
    Name = "Ativar Fly",
    Default = false,
    Callback = function(v)
        if v then startFly() else stopFly() end
    end
})

Tab1:AddSlider({
    Text = "Velocidade Fly",
    Min = 10,
    Max = 200,
    Default = 50,
    Callback = function(v) flySpeed = v end
})

-- ===== Speed System =====
Tab1:AddSection({"Speed System"})

Tab1:AddToggle({
    Name = "Ativar Speed",
    Default = false,
    Callback = function(v)
        speedEnabled = v
        humanoid.WalkSpeed = v and speedValue or 16
    end
})

Tab1:AddSlider({
    Text = "Velocidade",
    Min = 0,
    Max = 100,
    Default = 16,
    Callback = function(v)
        speedValue = v
        if speedEnabled then humanoid.WalkSpeed = v end
    end
})

-- ===== Jump System =====
Tab1:AddSection({"Jump System"})

Tab1:AddToggle({
    Name = "Ativar Jump",
    Default = false,
    Callback = function(v)
        jumpEnabled = v
        humanoid.JumpPower = v and jumpValue or 50
    end
})

Tab1:AddSlider({
    Text = "Força do Pulo",
    Min = 0,
    Max = 200,
    Default = 50,
    Callback = function(v)
        jumpValue = v
        if jumpEnabled then humanoid.JumpPower = v end
    end
})

-- ===== Click TP System =====
Tab1:AddSection({"Click TP System"})

Tab1:AddToggle({
    Name = "Ativar Click TP",
    Default = false,
    Callback = function(v)
        clickTPEnabled = v
        if v then setupClickTP() end
    end
})

-- ===== Config Tab =====
local Tab2 = Window:MakeTab({"Config", "rbxassetid://7733955511"})

Tab2:AddSection({"Sobre"})
Tab2:AddParagraph({"Dragon Hub 0.2", "Sistema completo de movimento"})

Tab2:AddButton({"Fechar", function()
    if flyEnabled then stopFly() end
    Window:Destroy()
end})

-- ===== Funções de Fly (existentes) =====
local function startFly()
    flyEnabled = true
    bodyGyro = Instance.new("BodyGyro")
    bodyGyro.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
    bodyGyro.P = 9000
    bodyGyro.Parent = rootPart

    bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    bodyVelocity.Velocity = Vector3.new(0, 0.1, 0)
    bodyVelocity.Parent = rootPart

    flyConnection = RunService.Heartbeat:Connect(function()
        local camera = workspace.CurrentCamera
        local move = Vector3.new(0, 0, 0)

        if UserInputService:IsKeyDown(Enum.KeyCode.W) then move = move + camera.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then move = move - camera.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then move = move - camera.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then move = move + camera.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then move = move + Vector3.new(0, 1, 0) end
        if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then move = move - Vector3.new(0, 1, 0) end

        bodyVelocity.Velocity = move.Magnitude > 0 and move.Unit * flySpeed or Vector3.new(0, 0.1, 0)
        bodyGyro.CFrame = camera.CFrame
    end)
end

local function stopFly()
    flyEnabled = false
    if flyConnection then flyConnection:Disconnect() end
    if bodyVelocity then bodyVelocity:Destroy() end
    if bodyGyro then bodyGyro:Destroy() end
end

-- ===== Atualização de Personagem =====
player.CharacterAdded:Connect(function(char)
    character = char
    humanoid = char:WaitForChild("Humanoid")
    rootPart = char:WaitForChild("HumanoidRootPart")
    if flyEnabled then stopFly() end
end)
